#define j(x) ((x)<0?-(x):(x))
#define r(i,a,b) for(int i=(a);i<(b);i++)
const int v[]={0,1,3,3,5,9,99};int N[]={-21,-19,-12,-8,8,12,19,21},K[]={-1,1,-10,10,-11,-9,9,11},bs,bd,b[120];void I(){r(i,0,120){int r=i/10,c=i%10,d="42356324"[c-1]-'0';b[i]=r<2||r>9||c<1||c>8?7:r==3?1:r==8?-1:r==2?d:r==9?-d:0;}}int S(int s,int d,int a,int be);int C(int s){int k=0,e=-s;r(i,21,99)if(b[i]==6*s){k=i;break;}if(!k)return 0;if(s==1){if(b[k+9]==-1||b[k+11]==-1)return 1;}else if(b[k-9]==1||b[k-11]==1)return 1;r(i,0,8)if(b[k+N[i]]==2*e)return 1;r(i,0,8)if(b[k+K[i]]==6*e)return 1;r(i,0,4){int t=k;while(1){t+=K[i];if(b[t]==7)break;if(!b[t])continue;if((b[t]>0)==(e>0)&&(j(b[t])==4||j(b[t])==5))return 1;break;}}r(i,4,8){int t=k;while(1){t+=K[i];if(b[t]==7)break;if(!b[t])continue;if((b[t]>0)==(e>0)&&(j(b[t])==3||j(b[t])==5))return 1;break;}}return 0;}int E(int s,int d,int a,int be,int u,int t,int p,int x,int*m){b[t]=p;b[u]=0;if(C(s)){b[u]=p;b[t]=x;return a;}*m=1;int sc=-S(-s,d?d-1:0,-be,-a);b[u]=p;b[t]=x;if(sc>a){a=sc;if(d==5)bs=u,bd=t;}return a>=be?be:a;}int S(int s,int d,int a,int be){int q=!d,m=0;if(q){int sc=0;r(i,21,99)if(b[i]!=7)sc+=b[i]>0?v[b[i]]:-v[-b[i]];sc*=s;if(sc>a)a=sc;if(a>=be)return be;}r(z,0,q?1:2){r(u,21,99){int p=b[u];if(p==7||!p||(p>0)!=(s>0))continue;int g=j(p);if(g==1){int o=s==1?10:-10;if(!z){for(int i=-1;i<=1;i+=2){int t=u+o+i,x=b[t];if(x&&x!=7&&(x>0)!=(s>0)){a=E(s,d,a,be,u,t,p,x,&m);if(a>=be)return be;}}}else if(!b[u+o]){int t=u+o;a=E(s,d,a,be,u,t,p,0,&m);if(a>=be)return be;if((s==1&&u<40||s==-1&&u>70)&&!b[u+2*o]){t=u+2*o;a=E(s,d,a,be,u,t,p,0,&m);if(a>=be)return be;}}}else{int*w=K,st,en;if(g==2)w=N,st=0,en=8;else if(g==4)st=0,en=4;else if(g==3)st=4,en=8;else st=0,en=8;r(i,st,en){int o=w[i],t=u,y=g!=2&&g!=6;while(1){t+=o;int tg=b[t];if(tg==7)break;if(tg&&(tg>0)==(s>0))break;if(!z){if(tg){a=E(s,d,a,be,u,t,p,tg,&m);if(a>=be)return be;break;}}else{if(!tg){a=E(s,d,a,be,u,t,p,0,&m);if(a>=be)return be;}else break;}if(!y)break;}}}}}if(!m&&!q)return C(s)?-9999:0;return a;}